<div class="card">
  <h2>Documentos Asociados</h2>
  
  <form id="formDocumento" class="grid-3">
    <div>
      <label for="idOrden">Orden</label>
      <select id="idOrden" name="idOrden" [(ngModel)]="documento.idOrden" required>
        <option value="">Seleccionar orden</option>
        <option *ngFor="let orden of ordenes" [value]="orden.idOrden">
          {{ orden.numeroOrden }}
        </option>
      </select>
    </div>
    
    <div>
      <label for="tipoDocumento">Tipo Documento</label>
      <select id="tipoDocumento" name="tipoDocumento" [(ngModel)]="documento.tipoDocumento" required>
        <option value="COTIZACION">Cotización</option>
        <option value="PO">PO</option>
        <option value="CONTRATO">Contrato</option>
        <option value="INVOICE">Invoice</option>
        <option value="REMESA">Remesa</option>
        <option value="OTRO">Otro</option>
      </select>
    </div>
    
    <div class="grid-span-3">
      <label for="nombreDocumento">Nombre Documento</label>
      <input type="text" id="nombreDocumento" name="nombreDocumento" [(ngModel)]="documento.nombreDocumento" required>
    </div>
    
    <div class="grid-span-3">
      <label for="rutaDocumento">Ruta Documento</label>
      <input type="text" id="rutaDocumento" name="rutaDocumento" [(ngModel)]="documento.rutaDocumento" required>
    </div>
    
    <div class="grid-span-3">
      <label for="descripcion">Descripción</label>
      <textarea id="descripcion" name="descripcion" [(ngModel)]="documento.descripcion" rows="3"></textarea>
    </div>
    
    <div>
      <label for="tamanoArchivo">Tamaño Archivo (bytes)</label>
      <input type="number" id="tamanoArchivo" name="tamanoArchivo" [(ngModel)]="documento.tamanoArchivo">
    </div>
    
    <div>
      <label for="tipoArchivo">Tipo Archivo</label>
      <input type="text" id="tipoArchivo" name="tipoArchivo" [(ngModel)]="documento.tipoArchivo">
    </div>
    
    <div>
      <label for="usuarioCarga">Usuario Carga</label>
      <input type="text" id="usuarioCarga" name="usuarioCarga" [(ngModel)]="documento.usuarioCarga">
    </div>
    
    <div class="align-end grid-3">
      <button type="button" class="btn-primary" (click)="crearDocumento()">Guardar</button>
      <button type="button" class="btn-secondary" (click)="Limpiar()">Limpiar</button>
      <button type="button" class="btn-danger" *ngIf="documento.idDocumento" (click)="Eliminar(documento)">Eliminar</button>
    </div>
  </form>
</div>

<div class="card">
  <h3>Búsqueda</h3>
  <div class="search-section grid-4">
    <div class="form-group">
      <label for="buscarOrden">Buscar por Orden</label>
      <input type="number" id="buscarOrden" #buscarOrden placeholder="ID Orden">
    </div>
    <div class="form-group">
      <label for="buscarTipo">Tipo Documento</label>
      <select id="buscarTipo" #buscarTipo>
        <option value="">Todos los tipos</option>
        <option value="COTIZACION">Cotización</option>
        <option value="PO">PO</option>
        <option value="CONTRATO">Contrato</option>
        <option value="INVOICE">Invoice</option>
        <option value="REMESA">Remesa</option>
        <option value="OTRO">Otro</option>
      </select>
    </div>
    <div class="form-group">
      <label for="buscarUsuario">Usuario Carga</label>
      <input type="text" id="buscarUsuario" #buscarUsuario placeholder="Usuario carga">
    </div>
    
    <div class="form-group">
      <button type="button" class="btn-secondary" (click)="buscarPorOrden(buscarOrden.value)">Buscar Orden</button>
    </div>
    <div class="form-group">
      <button type="button" class="btn-secondary" (click)="buscarPorTipoDocumento(buscarTipo.value)">Buscar Tipo</button>
    </div>
    <div class="form-group">
      <button type="button" class="btn-secondary" (click)="buscarPorUsuarioCarga(buscarUsuario.value)">Buscar Usuario</button>
    </div>
    <div class="form-group">
      <button type="button" class="btn-secondary" (click)="buscarDocumentos()">Mostrar Todos</button>
    </div>
  </div>
</div>

<div class="card">
  <h3>Lista de Documentos</h3>
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Orden</th>
          <th>Tipo</th>
          <th>Nombre Documento</th>
          <th>Tamaño</th>
          <th>Usuario</th>
          <th>Fecha Carga</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let d of documentos">
          <td>{{ d.idDocumento }}</td>
          <td>{{ d.orden?.numeroOrden }}</td>
          <td>
            <span class="badge bg-info">{{ d.tipoDocumento }}</span>
          </td>
          <td>{{ d.nombreDocumento }}</td>
          <td>{{ formatearTamanoArchivo(d.tamanoArchivo) }}</td>
          <td>{{ d.usuarioCarga || 'N/A' }}</td>
          <td>{{ d.fechaCarga | date:'short' }}</td>
          <td>
            <div class="action-buttons">
              <button class="btn-secondary" (click)="modificar(d)">Editar</button>
              <button class="btn-danger" (click)="Eliminar(d)">Eliminar</button>
            </div>
          </td>
        </tr>
        <tr *ngIf="documentos.length === 0">
          <td colspan="8" style="text-align: center;">No hay documentos registrados</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>